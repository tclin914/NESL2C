function cross_product(o,line) :((float,float),(float,float),(float,float)) ->float =
let (xo,yo) = o; 
    ((x1,y1),(x2,y2)) = line;
in (x1-xo)*(y2-yo) - (y1-yo)*(x2-xo);

function hsplit(points,p1,p2) :([(float, float)],(float,float),(float,float)) -> [(float,float)]=
let cross = {cross_product(p,(p1,p2)): p in points};
    packed = {p in points; c in cross | plusp(c)};
in if (#packed < 2) then [p1] ++ packed
   else
     let pm = points[max_index(cross)];
     in flatten({hsplit(packed,p1,p2): p1 in [p1,pm]; p2 in [pm,p2]});


a = [(0.577531706541777, 0.808918898925185), (0.132396893575788, 0.664780270308256), (0.193760132417083, -0.457153089344501), (0.646589430049062, -0.130812283605337), (-0.209794523194432, -0.433589778840542), (0.340891022235155, -0.572124496102333), (0.0729183778166771, -0.934797713533044), (0.111098842695355, -0.0284529179334641), (-0.784120177850127, -0.451073693111539), (0.90958820655942, 0.216707015410066), (-0.484516302123666, -0.373283643275499), (0.459137890487909, 0.603777576237917)];

minx = (-0.784120177850127, -0.451073693111539);
maxx = (0.90958820655942, 0.216707015410066);
hsplit(a,minx,maxx);

% answer is %
% it =
  [(-0.784120177850127, -0.451073693111539), (0.132396893575788, 0.664780270308256), (0.577531706541777, 0.808918898925185)]
  %
